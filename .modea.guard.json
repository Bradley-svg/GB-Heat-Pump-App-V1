{
  "forbiddenTerms": [
    "name",
    "fullName",
    "address",
    "street",
    "city",
    "province",
    "postal",
    "phone",
    "email",
    "ip",
    "mac",
    "serial",
    "serialNo",
    "imei",
    "imsi",
    "meid",
    "deviceId",
    "device_id",
    "deviceIdRaw",
    "gps",
    "lat",
    "lng",
    "latitude",
    "longitude",
    "geohash",
    "loc",
    "location",
    "zip",
    "postcode",
    "ssid",
    "bssid",
    "hostname",
    "ssid_password",
    "ssidPwd",
    "wifi_password",
    "router_mac",
    "bluetooth_mac",
    "photo",
    "image",
    "notes",
    "freeText",
    "rawPayload"
  ],
  "whitelistSafeIdentifiers": ["did_pseudo", "keyVersion", "timestamp_minute"],
  "piiRegex": {
    "ipv4": "\\b(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)\\b",
    "mac": "\\b([0-9A-Fa-f]{2}[:-]){5}[0-9A-Fa-f]{2}\\b",
    "imei": "\\b\\d{14,16}\\b",
    "gps": "\\b-?\\d{1,2}\\.\\d{4,}\\b"
  },
  "includeGlobs": ["**/*"],
  "excludeGlobs": [
    "**/node_modules/**",
    "**/.pnpm/**",
    "**/dist/**",
    "**/apps/**/dist/**",
    "**/services/**/dist/**",
    "**/.next/**",
    "**/build/**",
    "**/.wrangler/**",
    "**/coverage/**",
    "**/.cache/**",
    "**/guard-results/**",
    "**/*.min.*",
    "**/*.map",
    "pnpm-lock.yaml",
    ".modea.guard.json",
    "docs/mode-a/**",
    ".github/scripts/forbidden-fields-lint.js",
    "scripts/forbidden-fields-lint.js",
    "scripts/ensure-prod-shim-disabled.mjs",
    "scripts/publish-r2-assets.mjs",
    ".github/workflows/**",
    "docs/**/*.md",
    "scripts/db-sanity-check.mjs",
    "scripts/pii-regex-scan.js",
    "services/cn-gateway/test/**",
    "wrangler.toml",
    "package-lock.json"
  ],
  "allowlist": [
    {
      "path": ".dev.vars*",
      "pattern": "ip",
      "reason": "MODEA-GUARDS-000 sample env limit keys"
    },
    {
      "path": ".dev.vars*",
      "pattern": "email",
      "reason": "MODEA-GUARDS-000 sample env uses email placeholder"
    },
    {
      "path": ".dev.vars*",
      "pattern": "phone",
      "reason": "MODEA-GUARDS-000 sample env phone placeholder"
    },
    {
      "path": ".dev.vars*",
      "pattern": "ipv4",
      "reason": "dev vars point at localhost endpoints"
    },
    {
      "path": "services/overseas-api/package.json",
      "pattern": "ip",
      "reason": "package metadata contains dependency strings that include 'ip'"
    },
    {
      "path": "services/overseas-api/package.json",
      "pattern": "name",
      "reason": "package metadata requires the npm \"name\" field"
    },
    {
      "path": "services/overseas-api/package.json",
      "pattern": "gps",
      "reason": "package metadata may reference gps versions in dependency ranges"
    },
    {
      "path": "services/overseas-api/wrangler.toml",
      "pattern": "name",
      "reason": "Wrangler bindings require \"name\" keys for worker and D1 database references"
    },
    {
      "path": "services/overseas-api/wrangler.toml",
      "pattern": "ip",
      "reason": "Wrangler env vars include rate-limit fields that mention IP addresses"
    },
    {
      "path": "services/overseas-api/wrangler.toml",
      "pattern": "email",
      "reason": "Wrangler dev settings include placeholder email values"
    },
    {
      "path": "services/overseas-api/wrangler.toml",
      "pattern": "ipv4",
      "reason": "local dev config points at 127.0.0.1"
    },
    {
      "path": "package.json",
      "pattern": "name",
      "reason": "workspace metadata requires the package \"name\" field"
    },
    {
      "path": "apps/**/package.json",
      "pattern": "name",
      "reason": "app packages must declare their npm metadata"
    },
    {
      "path": "services/**/package.json",
      "pattern": "name",
      "reason": "service packages must declare their npm metadata"
    },
    {
      "path": "packages/**/package.json",
      "pattern": "name",
      "reason": "library packages must declare their npm metadata"
    },
    {
      "path": "packages/sdk-core/package.json",
      "pattern": "name",
      "reason": "package metadata requires the package \"name\" field"
    },
    {
      "path": "packages/sdk-core/src/pseudonymize.ts",
      "pattern": "deviceidraw",
      "reason": "code references the identifier to validate inputs"
    },
    {
      "path": "package.json",
      "pattern": "ipv4",
      "reason": "dev server binds to 0.0.0.0 for LAN testing"
    },
    {
      "path": ".github/workflows/**",
      "pattern": "ip",
      "reason": "workflow env vars legitimately reference IP limits"
    },
    {
      "path": ".github/workflows/**",
      "pattern": "email",
      "reason": "workflow env vars legitimately reference email placeholders"
    },
    {
      "path": ".github/workflows/full-ci.yml",
      "pattern": "email",
      "reason": "workflow references secret names"
    },
    {
      "path": ".github/workflows/full-ci.yml",
      "pattern": "ip",
      "reason": "workflow variables include IP limit settings"
    },
    {
      "path": ".github/workflows/mobile-detox.yml",
      "pattern": "email",
      "reason": "workflow references detox credentials"
    },
    {
      "path": ".github/workflows/mobile-detox.yml",
      "pattern": "ip",
      "reason": "workflow variables reference IP limits"
    },
    {
      "path": ".github/workflows/worker-ci.yml",
      "pattern": "ip",
      "reason": "worker CI references IP limit env vars"
    },
    {
      "path": ".github/workflows/worker-ci.yml",
      "pattern": "email",
      "reason": "worker CI references credential env vars"
    },
    {
      "path": "docs/password-reset-webhook.md",
      "pattern": "email",
      "reason": "documentation lists placeholder email examples"
    },
    {
      "path": "docs/password-reset-webhook.md",
      "pattern": "phone",
      "reason": "documentation includes phone placeholders"
    },
    {
      "path": "apps/mobile/README.md",
      "pattern": "email",
      "reason": "README references placeholder secrets"
    },
    {
      "path": "docs/deployment-runbook.md",
      "pattern": "ip",
      "reason": "runbook discusses IP throttling controls"
    },
    {
      "path": "scripts/ensure-prod-shim-disabled.mjs",
      "pattern": "email",
      "reason": "script references CLI env names containing email"
    },
    {
      "path": "scripts/ensure-prod-shim-disabled.mjs",
      "pattern": "ip",
      "reason": "script references env vars describing IP limits"
    },
    {
      "path": "docs/platform-setup-guide.md",
      "pattern": "ip",
      "reason": "setup guide documents IP-based limits"
    },
    {
      "path": "docs/telemetry-factory-integration-pack.md",
      "pattern": "ip",
      "reason": "integration pack covers IP-related deployment steps"
    },
    {
      "path": "scripts/publish-r2-assets.mjs",
      "pattern": "ip",
      "reason": "script references asset hostnames containing 'ip'"
    }
  ],
  "severityMap": {
    "ip": "P0",
    "mac": "P0",
    "ipv4": "P0",
    "imei": "P0",
    "imsi": "P0",
    "meid": "P0",
    "gps": "P0",
    "lat": "P0",
    "lng": "P0",
    "latitude": "P0",
    "longitude": "P0",
    "location": "P0",
    "loc": "P0",
    "deviceid": "P0",
    "device_id": "P0",
    "deviceidraw": "P0",
    "serial": "P0",
    "serialno": "P0",
    "ssid_password": "P0",
    "ssidpwd": "P0",
    "wifi_password": "P0",
    "router_mac": "P0",
    "bluetooth_mac": "P0",
    "email": "P1",
    "phone": "P1",
    "address": "P1",
    "street": "P1",
    "city": "P1",
    "province": "P1",
    "postal": "P1",
    "zip": "P1",
    "postcode": "P1",
    "hostname": "P1",
    "geohash": "P1",
    "bssid": "P1",
    "ssid": "P1",
    "photo": "P2",
    "image": "P3",
    "notes": "P2",
    "freetext": "P2",
    "rawpayload": "P2"
  },
  "baselineFile": "docs/guardrails/baseline.json"
}
