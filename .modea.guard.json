{
  "forbiddenTerms": [
    "name",
    "fullName",
    "address",
    "street",
    "city",
    "province",
    "postal",
    "phone",
    "email",
    "ip",
    "mac",
    "serial",
    "serialNo",
    "imei",
    "imsi",
    "meid",
    "deviceId",
    "device_id",
    "deviceIdRaw",
    "gps",
    "lat",
    "lng",
    "latitude",
    "longitude",
    "geohash",
    "loc",
    "location",
    "zip",
    "postcode",
    "ssid",
    "bssid",
    "hostname",
    "ssid_password",
    "ssidPwd",
    "wifi_password",
    "router_mac",
    "bluetooth_mac",
    "photo",
    "image",
    "notes",
    "freeText",
    "rawPayload"
  ],
  "whitelistSafeIdentifiers": [
    "did_pseudo",
    "keyVersion",
    "timestamp_minute"
  ],
  "piiRegex": {
    "ipv4": "\\b(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)\\b",
    "mac": "\\b([0-9A-Fa-f]{2}[:-]){5}[0-9A-Fa-f]{2}\\b",
    "imei": "\\b\\d{14,16}\\b",
    "gps": "\\b-?\\d{1,2}\\.\\d{4,}\\b"
  },
  "includeGlobs": [
    "**/*"
  ],
  "excludeGlobs": [
    "**/node_modules/**",
    "**/.pnpm/**",
    "**/dist/**",
    "**/apps/**/dist/**",
    "**/services/**/dist/**",
    "**/.next/**",
    "**/build/**",
    "**/.wrangler/**",
    "**/coverage/**",
    "**/.cache/**",
    "**/guard-results/**",
    "**/*.min.*",
    "**/*.map",
    "pnpm-lock.yaml",
    ".modea.guard.json",
    "docs/mode-a/**",
    ".github/scripts/forbidden-fields-lint.js",
    "scripts/forbidden-fields-lint.js",
    "scripts/ensure-prod-shim-disabled.mjs",
    "scripts/publish-r2-assets.mjs",
    ".github/workflows/**",
    "docs/**/*.md",
    "scripts/db-sanity-check.mjs",
    "scripts/pii-regex-scan.js",
    "services/cn-gateway/test/**",
    "wrangler.toml",
    "package-lock.json"
  ],
  "allowlist": [
    {
      "path": ".dev.vars*",
      "pattern": "ip",
      "reason": "MODEA-GUARDS-000 sample env limit keys"
    },
    {
      "path": ".dev.vars*",
      "pattern": "email",
      "reason": "MODEA-GUARDS-000 sample env uses email placeholder"
    },
    {
      "path": ".dev.vars*",
      "pattern": "phone",
      "reason": "MODEA-GUARDS-000 sample env phone placeholder"
    },
    {
      "path": ".dev.vars*",
      "pattern": "ipv4",
      "reason": "dev vars point at localhost endpoints"
    },
    {
      "path": "services/overseas-api/package.json",
      "pattern": "ip",
      "reason": "package metadata contains dependency strings that include 'ip'"
    },
    {
      "path": "services/overseas-api/package.json",
      "pattern": "name",
      "reason": "package metadata requires the npm \"name\" field"
    },
    {
      "path": "services/overseas-api/package.json",
      "pattern": "gps",
      "reason": "package metadata may reference gps versions in dependency ranges"
    },
    {
      "path": "services/overseas-api/wrangler.toml",
      "pattern": "name",
      "reason": "Wrangler bindings require \"name\" keys for worker and D1 database references"
    },
    {
      "path": "services/overseas-api/wrangler.toml",
      "pattern": "ip",
      "reason": "Wrangler env vars include rate-limit fields that mention IP addresses"
    },
    {
      "path": "services/overseas-api/wrangler.toml",
      "pattern": "email",
      "reason": "Wrangler dev settings include placeholder email values"
    },
    {
      "path": "services/overseas-api/wrangler.toml",
      "pattern": "ipv4",
      "reason": "local dev config points at 127.0.0.1"
    },
    {
      "path": "package.json",
      "pattern": "name",
      "reason": "workspace metadata requires the package \"name\" field"
    },
    {
      "path": "apps/**/package.json",
      "pattern": "name",
      "reason": "app packages must declare their npm metadata"
    },
    {
      "path": "services/**/package.json",
      "pattern": "name",
      "reason": "service packages must declare their npm metadata"
    },
    {
      "path": "packages/**/package.json",
      "pattern": "name",
      "reason": "library packages must declare their npm metadata"
    },
    {
      "path": "packages/sdk-core/package.json",
      "pattern": "name",
      "reason": "package metadata requires the package \"name\" field"
    },
    {
      "path": "packages/sdk-core/src/pseudonymize.ts",
      "pattern": "deviceidraw",
      "reason": "code references the identifier to validate inputs"
    },
    {
      "path": "package.json",
      "pattern": "ipv4",
      "reason": "dev server binds to 0.0.0.0 for LAN testing"
    },
    {
      "path": ".github/workflows/**",
      "pattern": "ip",
      "reason": "workflow env vars legitimately reference IP limits"
    },
    {
      "path": ".github/workflows/**",
      "pattern": "email",
      "reason": "workflow env vars legitimately reference email placeholders"
    },
    {
      "path": ".github/workflows/full-ci.yml",
      "pattern": "email",
      "reason": "workflow references secret names"
    },
    {
      "path": ".github/workflows/full-ci.yml",
      "pattern": "ip",
      "reason": "workflow variables include IP limit settings"
    },
    {
      "path": ".github/workflows/mobile-detox.yml",
      "pattern": "email",
      "reason": "workflow references detox credentials"
    },
    {
      "path": ".github/workflows/mobile-detox.yml",
      "pattern": "ip",
      "reason": "workflow variables reference IP limits"
    },
    {
      "path": ".github/workflows/worker-ci.yml",
      "pattern": "ip",
      "reason": "worker CI references IP limit env vars"
    },
    {
      "path": ".github/workflows/worker-ci.yml",
      "pattern": "email",
      "reason": "worker CI references credential env vars"
    },
    {
      "path": "docs/password-reset-webhook.md",
      "pattern": "email",
      "reason": "documentation lists placeholder email examples"
    },
    {
      "path": "docs/password-reset-webhook.md",
      "pattern": "phone",
      "reason": "documentation includes phone placeholders"
    },
    {
      "path": "apps/mobile/README.md",
      "pattern": "email",
      "reason": "README references placeholder secrets"
    },
    {
      "path": "docs/deployment-runbook.md",
      "pattern": "ip",
      "reason": "runbook discusses IP throttling controls"
    },
    {
      "path": "scripts/ensure-prod-shim-disabled.mjs",
      "pattern": "email",
      "reason": "script references CLI env names containing email"
    },
    {
      "path": "scripts/ensure-prod-shim-disabled.mjs",
      "pattern": "ip",
      "reason": "script references env vars describing IP limits"
    },
    {
      "path": "docs/platform-setup-guide.md",
      "pattern": "ip",
      "reason": "setup guide documents IP-based limits"
    },
    {
      "path": "docs/telemetry-factory-integration-pack.md",
      "pattern": "ip",
      "reason": "integration pack covers IP-related deployment steps"
    },
    {
      "path": "scripts/publish-r2-assets.mjs",
      "pattern": "ip",
      "reason": "script references asset hostnames containing 'ip'"
    },
    {
      "path": "services/cn-gateway/src/validators/telemetry.schema.json",
      "pattern": "deviceid",
      "reason": "Telemetry JSON schema references the canonical device identifier field"
    },
    {
      "path": "apps/dashboard-web/eslint.config.js",
      "pattern": "location",
      "reason": "ESLint config defines browser globals"
    },
    {
      "path": "apps/dashboard-web/eslint.config.js",
      "pattern": "image",
      "reason": "ESLint config enumerates DOM globals"
    },
    {
      "path": "apps/dashboard-web/src/app/hooks/use-api-request.ts",
      "pattern": "name",
      "reason": "DOMException.name comparisons for abort handling"
    },
    {
      "path": "apps/dashboard-web/src/pages/alerts/__tests__/ActionDialog.test.tsx",
      "pattern": "device_id",
      "reason": "Fixture data requires canonical device_id field"
    },
    {
      "path": "apps/dashboard-web/src/pages/alerts/__tests__/ActionDialog.test.tsx",
      "pattern": "name",
      "reason": "Testing-library selectors reference accessible names"
    },
    {
      "path": "apps/dashboard-web/src/__tests__/config.test.ts",
      "pattern": "location",
      "reason": "Config tests stub window.location to validate sanitized return handling"
    },
    {
      "path": "apps/dashboard-web/src/__tests__/config.test.ts",
      "pattern": "hostname",
      "reason": "Config tests inspect URL.hostname when mocking window.location"
    },
    {
      "path": "apps/mobile/src/components/GBListItem.tsx",
      "pattern": "name",
      "reason": "Icon props pass through the name attribute"
    },
    {
      "path": "apps/mobile/src/screens/AlertsScreen.tsx",
      "pattern": "device_id",
      "reason": "Alert detail UI displays the canonical device_id field"
    },
    {
      "path": "apps/mobile/src/screens/DashboardScreen.tsx",
      "pattern": "name",
      "reason": "Icon props pass through the name attribute"
    },
    {
      "path": "apps/mobile/src/types/expo-vector-icons.d.ts",
      "pattern": "name",
      "reason": "Type declarations for icon name unions"
    },
    {
      "path": "packages/sdk-web/src/client.test.ts",
      "pattern": "device_id",
      "reason": "SDK fixtures validate canonical device_id handling"
    },
    {
      "path": "services/overseas-api/src/utils/ed25519.ts",
      "pattern": "name",
      "reason": "WebCrypto algorithm identifiers require name fields"
    },
    {
      "path": "services/overseas-api/tests/integration/client-events.integration.test.ts",
      "pattern": "email",
      "reason": "Integration tests assert user_email hashing behaviour"
    },
    {
      "path": "services/overseas-api/tests/integration/ingest.integration.test.ts",
      "pattern": "device_id",
      "reason": "Integration tests seed telemetry rows with device_id prefixes"
    },
    {
      "path": "services/cn-gateway/types/external-shims/index.d.ts",
      "pattern": "mac",
      "reason": "Third-party SDK shape includes MAC field names"
    },
    {
      "path": "services/cn-gateway/src/validators/common.ts",
      "pattern": "deviceId",
      "reason": "Validation schema defines canonical deviceId field"
    },
    {
      "path": "services/overseas-api/src/routes/auth.ts",
      "pattern": "email",
      "reason": "Auth routes legitimately accept user email addresses (masked before logging)"
    },
    {
      "path": "services/overseas-api/src/routes/auth.ts",
      "pattern": "phone",
      "reason": "Auth routes validate phone placeholders for compliance notices"
    },
    {
      "path": "services/overseas-api/src/routes/auth.ts",
      "pattern": "ip",
      "reason": "Rate-limit messages reference IP throttles for audit logging"
    },
    {
      "path": "services/overseas-api/src/env.ts",
      "pattern": "ip",
      "reason": "Env validation enforces IP-based rate limit settings"
    },
    {
      "path": "services/overseas-api/src/env.ts",
      "pattern": "email",
      "reason": "Env schema configures webhook email recipients/secrets"
    },
    {
      "path": "services/overseas-api/src/routes/alerts.ts",
      "pattern": "device_id",
      "reason": "Alerts API works with the pseudonymous devices.device_id column"
    },
    {
      "path": "services/overseas-api/src/routes/alerts.ts",
      "pattern": "deviceId",
      "reason": "Alerts API works with the pseudonymous devices.device_id column"
    },
    {
      "path": "services/overseas-api/src/routes/alerts.ts",
      "pattern": "ip",
      "reason": "Alert payloads include client IP metadata for audit trails"
    },
    {
      "path": "services/overseas-api/src/routes/client.ts",
      "pattern": "device_id",
      "reason": "Client routes reference the pseudonymous device_id column"
    },
    {
      "path": "services/overseas-api/src/routes/commissioning-runs.ts",
      "pattern": "device_id",
      "reason": "Commissioning workflows reference the pseudonymous device_id column"
    },
    {
      "path": "services/overseas-api/src/routes/commissioning-runs.ts",
      "pattern": "deviceId",
      "reason": "Commissioning workflows reference the pseudonymous device_id column"
    },
    {
      "path": "services/overseas-api/src/routes/devices.ts",
      "pattern": "device_id",
      "reason": "Device roster queries rely on the pseudonymous device_id column"
    },
    {
      "path": "services/overseas-api/src/routes/devices.ts",
      "pattern": "deviceId",
      "reason": "Device roster queries rely on the pseudonymous device_id column"
    },
    {
      "path": "services/overseas-api/src/routes/telemetry.legacy.ts",
      "pattern": "device_id",
      "reason": "Legacy telemetry endpoint still addresses the pseudonymous device_id column"
    },
    {
      "path": "services/overseas-api/src/routes/admin.ts",
      "pattern": "device_id",
      "reason": "Admin tooling reads from the pseudonymous device_id column"
    },
    {
      "path": "services/overseas-api/src/routes/admin.ts",
      "pattern": "deviceId",
      "reason": "Admin tooling reads from the pseudonymous device_id column"
    },
    {
      "path": "services/overseas-api/src/routes/telemetry.legacy.ts",
      "pattern": "deviceId",
      "reason": "Legacy telemetry endpoint still addresses the pseudonymous device_id column"
    },
    {
      "path": "services/overseas-api/src/lib/alerts-store.ts",
      "pattern": "device_id",
      "reason": "Alerts data store uses the pseudonymous device_id column"
    },
    {
      "path": "services/overseas-api/src/lib/alerts-store.ts",
      "pattern": "deviceId",
      "reason": "Alerts data store uses the pseudonymous device_id column"
    },
    {
      "path": "services/overseas-api/src/lib/alerts-store.ts",
      "pattern": "email",
      "reason": "Alerts store masks/administer operator emails"
    },
    {
      "path": "services/overseas-api/src/lib/commissioning-store.ts",
      "pattern": "device_id",
      "reason": "Commissioning store uses the pseudonymous device_id column"
    },
    {
      "path": "services/overseas-api/src/lib/commissioning-store.ts",
      "pattern": "deviceId",
      "reason": "Commissioning store uses the pseudonymous device_id column"
    },
    {
      "path": "services/overseas-api/src/lib/ip-rate-limit.ts",
      "pattern": "ip",
      "reason": "Rate limit helper manages IP allowance state"
    },
    {
      "path": "services/overseas-api/src/lib/__tests__/ip-rate-limit.test.ts",
      "pattern": "ip",
      "reason": "Rate limit tests exercise IP scenarios"
    },
    {
      "path": "services/overseas-api/src/__tests__/env.validation.test.ts",
      "pattern": "ip",
      "reason": "Env validation tests exercise IP limit settings"
    },
    {
      "path": "services/overseas-api/src/__tests__/env.validation.test.ts",
      "pattern": "email",
      "reason": "Env validation tests cover webhook email configuration"
    },
    {
      "path": "services/overseas-api/src/routes/__tests__/auth.signup-verify.test.ts",
      "pattern": "email",
      "reason": "Signup integration tests assert email verification flow"
    },
    {
      "path": "services/overseas-api/tests/integration/api-flows.integration.test.ts",
      "pattern": "device_id",
      "reason": "Integration tests seed device fixtures via the pseudonymous column"
    },
    {
      "path": "services/overseas-api/tests/integration/worker.integration.test.ts",
      "pattern": "device_id",
      "reason": "Integration tests seed device fixtures via the pseudonymous column"
    },
    {
      "path": "services/overseas-api/tests/security/worker.security.test.ts",
      "pattern": "device_id",
      "reason": "Security regression tests operate on pseudonymous device identifiers"
    },
    {
      "path": "services/overseas-api/src/routes/commissioning-runs.ts",
      "pattern": "email",
      "reason": "Commissioning notifications include operator email metadata"
    },
    {
      "path": "services/overseas-api/src/routes/auth.ts",
      "pattern": "name",
      "reason": "Auth routes inspect human-readable names for logging"
    },
    {
      "path": "services/overseas-api/src/lib/access.ts",
      "pattern": "email",
      "reason": "Access shim masks admin emails during login"
    },
    {
      "path": "services/overseas-api/src/lib/access.ts",
      "pattern": "ip",
      "reason": "Access logging redacts client IP metadata"
    },
    {
      "path": "services/overseas-api/src/routes/devices.ts",
      "pattern": "email",
      "reason": "Device roster responses surface masked operator email metadata"
    },
    {
      "path": "services/overseas-api/tests/integration/audit.integration.test.ts",
      "pattern": "email",
      "reason": "Audit integration tests assert email hashing"
    },
    {
      "path": "services/overseas-api/tests/integration/audit.integration.test.ts",
      "pattern": "device_id",
      "reason": "Audit integration tests operate on pseudonymous device identifiers"
    },
    {
      "path": "services/overseas-api/src/frontend/static-bundle.ts",
      "pattern": "device_id",
      "reason": "Embedded SPA assets still reference legacy telemetry fields"
    },
    {
      "path": "services/overseas-api/migrations/0012_enforce_foreign_keys.sql",
      "pattern": "device_id",
      "reason": "Historic migration references the canonical column name"
    },
    {
      "path": "packages/sdk-core/src/constants.ts",
      "pattern": "mac",
      "reason": "SAFE metric list enumerates allowed `mac`-prefixed metrics for DROP enforcement"
    },
    {
      "path": "packages/sdk-core/src/constants.ts",
      "pattern": "ssid",
      "reason": "SAFE metric list enumerates allowed `ssid` keys for DROP enforcement"
    },
    {
      "path": "packages/sdk-core/src/constants.ts",
      "pattern": "name",
      "reason": "SAFE metric metadata includes human-readable names"
    },
    {
      "path": "packages/sdk-core/src/constants.ts",
      "pattern": "address",
      "reason": "SAFE metric metadata references addressable fields"
    },
    {
      "path": "services/cn-gateway/src/modea/drop-safe.ts",
      "pattern": "deviceId",
      "reason": "CN-side sanitizer enumerates canonical device identifier keys"
    },
    {
      "path": "services/cn-gateway/src/modea/drop-safe.ts",
      "pattern": "mac",
      "reason": "DROP sanitizer rejects MAC-prefixed fields"
    },
    {
      "path": "services/cn-gateway/src/modea/drop-safe.ts",
      "pattern": "serial",
      "reason": "DROP sanitizer rejects serial fields"
    },
    {
      "path": "services/cn-gateway/README.md",
      "pattern": "deviceId",
      "reason": "CN documentation references the canonical identifier terminology"
    },
    {
      "path": "services/cn-gateway/README.md",
      "pattern": "ip",
      "reason": "CN documentation references IP-level safeguards"
    },
    {
      "path": "services/cn-gateway/README.md",
      "pattern": "mac",
      "reason": "CN documentation references MAC-level safeguards"
    }
  ],
  "severityMap": {
    "ip": "P0",
    "mac": "P0",
    "ipv4": "P0",
    "imei": "P0",
    "imsi": "P0",
    "meid": "P0",
    "gps": "P0",
    "lat": "P0",
    "lng": "P0",
    "latitude": "P0",
    "longitude": "P0",
    "location": "P0",
    "loc": "P0",
    "deviceid": "P0",
    "device_id": "P0",
    "deviceidraw": "P0",
    "serial": "P0",
    "serialno": "P0",
    "ssid_password": "P0",
    "ssidpwd": "P0",
    "wifi_password": "P0",
    "router_mac": "P0",
    "bluetooth_mac": "P0",
    "email": "P1",
    "phone": "P1",
    "address": "P1",
    "street": "P1",
    "city": "P1",
    "province": "P1",
    "postal": "P1",
    "zip": "P1",
    "postcode": "P1",
    "hostname": "P1",
    "geohash": "P1",
    "bssid": "P1",
    "ssid": "P1",
    "photo": "P2",
    "image": "P3",
    "notes": "P2",
    "freetext": "P2",
    "rawpayload": "P2"
  },
  "baselineFile": "docs/guardrails/baseline.json"
}
