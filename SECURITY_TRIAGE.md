# Security Triage (P0/P1, 48-hour actions)

| ID | Severity | Owner | 48h Action Plan |
| --- | --- | --- | --- |
| P0-overseas-raw-ingest | P0 | Platform API Lead + CN Gateway Lead | 1) Halt any production use of `ALLOW_RAW_INGEST`; 2) Export the current D1 `devices`, `latest_state`, `telemetry`, and `ops_metrics` tables for forensic backup; 3) Stand up a staging worker that accepts `{ didPseudo }` batches and prove CN exports can write to it; 4) Publish a rollback plan (Cloudflare Access blocks, wrangler env diff) before touching prod. |
| P0-export-signature-missing | P0 | Security Engineering | 1) Generate a fresh Ed25519 verification keypair and store the public key as `EXPORT_VERIFY_PUBKEY` in staging; 2) Implement a minimal verifier that rejects unsigned batches and exposes `signatureConfigured` on `/health`; 3) Add a sentinel cron/test that fails if `/health` lacks verification metadata; 4) Block further exports until staging verification passes. |
| P1-logs-leak-device-id | P1 | Observability Lead | 1) Disable any external log shipping that includes `device_id`; 2) Add temporary filters in log pipeline to scrub `device_id` until code fixes land; 3) Inventory D1 tables (`ops_metrics`, `ingest_batches`) containing raw IDs and plan a purge/hardening story; 4) File follow-up tickets to migrate to pseudonymous IDs alongside exporter schema work. |
| P1-allow-raw-ingest-unguarded | P1 (fixed) | Platform API Lead | 1) Roll the new env validation + CI script to all pipelines; 2) Audit Cloudflare secrets to ensure `ALLOW_RAW_INGEST` is absent outside local/test; 3) Add monitoring for the new validation failure logs. |
| P1-schema-drift-didPseudo | P1 | SDK/Core Lead | 1) Diff `packages/sdk-core/src/schemas.ts` vs `services/overseas-api/src/schemas/ingest.ts`; 2) Produce a shared schema package; 3) Schedule a contract test that fails until both sides agree. |
| P1-modea-doc-drift | P1 | Compliance Lead | 1) Redline the existing guard checklist/pr summary to mark blockers; 2) Require fresh evidence links (health endpoints, CI artifacts) before re-marking anything as “Pass”; 3) Notify legal/regulatory stakeholders of the discrepancy. |
