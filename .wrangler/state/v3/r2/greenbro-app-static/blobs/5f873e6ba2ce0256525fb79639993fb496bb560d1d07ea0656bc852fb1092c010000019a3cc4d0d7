import{u as h,r as t,j as e}from"./index.js";import{P as r,b as m,a as o}from"./format.js";function j(){const c=h(),[d,l]=t.useState("loading"),[a,n]=t.useState(null);return t.useEffect(()=>{const s=new AbortController;return l("loading"),c.get("/api/archive/offline",{signal:s.signal}).then(i=>{n(i),l("ready")}).catch(i=>{i instanceof DOMException&&i.name==="AbortError"||l("error")}),()=>s.abort()},[c]),d==="loading"?e.jsx(r,{title:"Archive",children:e.jsx("div",{className:"card",children:"Loading..."})}):d==="error"||!a?e.jsx(r,{title:"Archive",children:e.jsx("div",{className:"card callout error",children:"Unable to load archive data"})}):e.jsxs(r,{title:"Archive",children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"card-title",children:"Offline devices"}),e.jsxs("span",{className:"pill",children:[a.offline?.length??0," entries"]})]}),a.offline?.length?e.jsx("div",{className:"stack",children:a.offline.map(s=>e.jsxs("div",{className:"list-item",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:s.device_id}),s.site?e.jsx("div",{className:"subdued",children:s.site}):null,e.jsxs("div",{className:"meta",children:["Last heartbeat ",m(s.last_seen_at)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"meta",children:["Alerts ",s.alerts]}),e.jsx("a",{href:`/app/device?device=${encodeURIComponent(s.lookup)}`,className:"link",children:"Open"})]})]},s.lookup))}):e.jsx("div",{className:"empty",children:"No offline devices found"})]}),e.jsxs("div",{className:"card mt-1",children:[e.jsx("div",{className:"card-header",children:e.jsx("div",{className:"card-title",children:"Telemetry archive volume"})}),a.history?.length?e.jsx("div",{className:"history-grid",children:a.history.map((s,i)=>e.jsxs("div",{className:"history-card",children:[e.jsx("strong",{children:s.day}),e.jsxs("div",{className:"subdued",children:[o(s.samples??0,0)," samples"]})]},`${s.day}-${i}`))}):e.jsx("div",{className:"empty",children:"No recent telemetry samples"})]})]})}export{j as default};
